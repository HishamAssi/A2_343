SELECT e.election_id, cabinet.id FROM (SELECT e1.e_date as e_start, e2.e_date as e_end, e1.id as election_id, e1.country_id as country_id  FROM election e1, election e2 WHER
E e1.country_id = e2.country_id AND (e1.id = e2.previous_parliament_election_id AND e1.e_type = 'Parliamentary election' AND e2.e_type = 'Parliamentary election') OR (e1.id = e2.previous_ep_el
ection_id AND e1.e_type = 'European Parliament' AND e2.e_type = 'European Parliament') OR (e1.e_date IN (SELECT max(e3.e_date) FROM election e3 WHERE e3.e_type = 'Parliamentary election' GROUP
 BY e3.country_id) AND e2.e_date=e1.e_date) OR (e1.e_date IN (SELECT max(e3.e_date) FROM election e3 WHERE e3.e_type = 'European Parliament' GROUP BY e3.country_id) AND e2.e_date = e1.e_date))
AS e JOIN cabinet ON cabinet.country_id=e.country_id AND ((e.e_start <= cabinet.start_date AND cabinet.start_date < e.e_end) OR (e.e_start=e.e_end AND e.e_start <= cabinet.start_date));